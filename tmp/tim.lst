                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler
                                      3 ; Version 4.5.0 #15242 (Linux)
                                      4 ;--------------------------------------------------------
                                      5 	.module tim
                                      6 	
                                      7 ;--------------------------------------------------------
                                      8 ; Public variables in this module
                                      9 ;--------------------------------------------------------
                                     10 	.globl _delay_1_sec
                                     11 	.globl _delay_1_ms
                                     12 	.globl _delay_ms
                                     13 ;--------------------------------------------------------
                                     14 ; ram data
                                     15 ;--------------------------------------------------------
                                     16 	.area DATA
                                     17 ;--------------------------------------------------------
                                     18 ; ram data
                                     19 ;--------------------------------------------------------
                                     20 	.area INITIALIZED
                                     21 ;--------------------------------------------------------
                                     22 ; absolute external ram data
                                     23 ;--------------------------------------------------------
                                     24 	.area DABS (ABS)
                                     25 
                                     26 ; default segment ordering for linker
                                     27 	.area HOME
                                     28 	.area GSINIT
                                     29 	.area GSFINAL
                                     30 	.area CONST
                                     31 	.area INITIALIZER
                                     32 	.area CODE
                                     33 
                                     34 ;--------------------------------------------------------
                                     35 ; global & static initialisations
                                     36 ;--------------------------------------------------------
                                     37 	.area HOME
                                     38 	.area GSINIT
                                     39 	.area GSFINAL
                                     40 	.area GSINIT
                                     41 ;--------------------------------------------------------
                                     42 ; Home
                                     43 ;--------------------------------------------------------
                                     44 	.area HOME
                                     45 	.area HOME
                                     46 ;--------------------------------------------------------
                                     47 ; code
                                     48 ;--------------------------------------------------------
                                     49 	.area CODE
                                     50 ;	tim.c: 4: void delay_1_sec(void){
                                     51 ;	-----------------------------------------
                                     52 ;	 function delay_1_sec
                                     53 ;	-----------------------------------------
      000000                         54 _delay_1_sec:
                                     55 ;	tim.c: 5: uint8_t uif_flag = 0;
      000000 5F               [ 1]   56 	clrw	x
                                     57 ;	tim.c: 6: TIM2_CR1 = TIM2_CR1 & 0xFE;
      000001 72 11 53 00      [ 1]   58 	bres	0x5300, #0
                                     59 ;	tim.c: 7: TIM2_PSCR = 8; // 16 MHz / 256
      000005 35 08 53 0E      [ 1]   60 	mov	0x530e+0, #0x08
                                     61 ;	tim.c: 8: TIM2_ARRH = 0xF4;
      000009 35 F4 53 0F      [ 1]   62 	mov	0x530f+0, #0xf4
                                     63 ;	tim.c: 9: TIM2_ARRL = 0x24;
      00000D 35 24 53 10      [ 1]   64 	mov	0x5310+0, #0x24
                                     65 ;	tim.c: 10: TIM2_SR1 = TIM2_SR1 & (0b11111110);
      000011 72 11 53 04      [ 1]   66 	bres	0x5304, #0
                                     67 ;	tim.c: 11: TIM2_CR1 = TIM2_CR1 | (0b00000001);
      000015 72 10 53 00      [ 1]   68 	bset	0x5300, #0
                                     69 ;	tim.c: 12: while(!(uif_flag)){
      000019                         70 00101$:
      000019 9F               [ 1]   71 	ld	a, xl
      00001A 4D               [ 1]   72 	tnz	a
      00001B 27 01            [ 1]   73 	jreq	00120$
      00001D 81               [ 4]   74 	ret
      00001E                         75 00120$:
                                     76 ;	tim.c: 13: uif_flag = TIM2_SR1 & (0b00000001);
      00001E C6 53 04         [ 1]   77 	ld	a, 0x5304
      000021 A4 01            [ 1]   78 	and	a, #0x01
      000023 97               [ 1]   79 	ld	xl, a
      000024 20 F3            [ 2]   80 	jra	00101$
                                     81 ;	tim.c: 15: }
      000026 81               [ 4]   82 	ret
                                     83 ;	tim.c: 17: void delay_1_ms(void){
                                     84 ;	-----------------------------------------
                                     85 ;	 function delay_1_ms
                                     86 ;	-----------------------------------------
      000027                         87 _delay_1_ms:
                                     88 ;	tim.c: 18: uint8_t uif_flag = 0;
      000027 5F               [ 1]   89 	clrw	x
                                     90 ;	tim.c: 19: TIM2_CR1 = TIM2_CR1 & 0xFE;
      000028 72 11 53 00      [ 1]   91 	bres	0x5300, #0
                                     92 ;	tim.c: 20: TIM2_PSCR = 1; 
      00002C 35 01 53 0E      [ 1]   93 	mov	0x530e+0, #0x01
                                     94 ;	tim.c: 21: TIM2_ARRH = 0x1F;
      000030 35 1F 53 0F      [ 1]   95 	mov	0x530f+0, #0x1f
                                     96 ;	tim.c: 22: TIM2_ARRL = 0x40;
      000034 35 40 53 10      [ 1]   97 	mov	0x5310+0, #0x40
                                     98 ;	tim.c: 23: TIM2_SR1 &= ~0x01;
      000038 72 11 53 04      [ 1]   99 	bres	0x5304, #0
                                    100 ;	tim.c: 24: TIM2_SR1 = TIM2_SR1 & (0b11111110);
      00003C 72 11 53 04      [ 1]  101 	bres	0x5304, #0
                                    102 ;	tim.c: 25: TIM2_CR1 = TIM2_CR1 | (0b00000001);
      000040 72 10 53 00      [ 1]  103 	bset	0x5300, #0
                                    104 ;	tim.c: 26: while(!(uif_flag)){
      000044                        105 00101$:
      000044 9F               [ 1]  106 	ld	a, xl
      000045 4D               [ 1]  107 	tnz	a
      000046 27 01            [ 1]  108 	jreq	00120$
      000048 81               [ 4]  109 	ret
      000049                        110 00120$:
                                    111 ;	tim.c: 27: uif_flag = TIM2_SR1 & (0b00000001);
      000049 C6 53 04         [ 1]  112 	ld	a, 0x5304
      00004C A4 01            [ 1]  113 	and	a, #0x01
      00004E 97               [ 1]  114 	ld	xl, a
      00004F 20 F3            [ 2]  115 	jra	00101$
                                    116 ;	tim.c: 29: }
      000051 81               [ 4]  117 	ret
                                    118 ;	tim.c: 31: void delay_ms(int ms){
                                    119 ;	-----------------------------------------
                                    120 ;	 function delay_ms
                                    121 ;	-----------------------------------------
      000052                        122 _delay_ms:
      000052 89               [ 2]  123 	pushw	x
                                    124 ;	tim.c: 33: for (i = 0; i < ms; i++){
      000053 5F               [ 1]  125 	clrw	x
      000054                        126 00103$:
      000054 13 01            [ 2]  127 	cpw	x, (0x01, sp)
      000056 2E 08            [ 1]  128 	jrsge	00105$
                                    129 ;	tim.c: 34: delay_1_ms();
      000058 89               [ 2]  130 	pushw	x
      000059 CDr00r27         [ 4]  131 	call	_delay_1_ms
      00005C 85               [ 2]  132 	popw	x
                                    133 ;	tim.c: 33: for (i = 0; i < ms; i++){
      00005D 5C               [ 1]  134 	incw	x
      00005E 20 F4            [ 2]  135 	jra	00103$
      000060                        136 00105$:
                                    137 ;	tim.c: 36: }
      000060 5B 02            [ 2]  138 	addw	sp, #2
      000062 81               [ 4]  139 	ret
                                    140 	.area CODE
                                    141 	.area CONST
                                    142 	.area INITIALIZER
                                    143 	.area CABS (ABS)
